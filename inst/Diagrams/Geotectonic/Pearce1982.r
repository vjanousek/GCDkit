#####################################################################
#                      Zr-Ti  geotectonic                           #
#                         Pearce 1982                               #
#####################################################################
# JFM March 2012

Pearce1982<-function(){
if(!getOption("gcd.plot.bw")){
        col1<-plt.col[1]
        col2<-plt.col[2]
}else{
    col1<-"black"
    col2<-"black"
}


what<-WR[,"Zr"]>0 & WR[,"Ti"]>0
x.data<<-WR[what,"Zr"]
y.data<<-WR[what,"Ti"]

temp<-list(
        lines1=list(
        "lines",
        x=c(96.46493265,94.88434585,90.89521849,86.50004734,80.96974545,76.54677856,70.71067812,62.16191891,55.37326468,47.72347618,39.92461791,33.5110517,29.36262619,27.12395281,24.16176728,21.80955175,18.6727171,17.24906669,16.3609432,15.62148208,14.7193214,14.10049174,13.59727532,13.37448272,13.33043808,13.6422016,14.33537823,14.76815968,15.5183325,15.93417947,16.74381424,18.36676291,20.28065632,22.17285603,24.89120493,28.78640471,33.290699,38.24610725,43.93975006,51.15219003,58.37990892,67.06991216,77.82189751,85.93126428,95.19784989,112.6716636,140.126717,158.8725861,180.7213886,197.5855616,210.385694,230.7780119,247.3617866,261.6546545,267.7740616,270.4408179,270.4408179,271.3381326,272.2346514,273.1341324,274.9458307,275.8580928),
        y=c(1006.712304,1090.831603,1259.493398,1463.974002,1673.464597,1831.571526,1971.354603,2079.704692,2186.668044,2306.819892,2425.464232,2491.209717,2507.931473,2458.099941,2345.708725,2208.705829,2031.589219,1945.181315,1912.932711,1900.178139,1919.328607,1964.785337,2045.225863,2150.415901,2393.228255,2838.165523,3434.056591,3886.238969,4325.110945,4578.084615,4944.022252,5613.8164,6226.876053,6747.08941,7286.40097,7790.30837,8218.366001,8497.795384,8699.054297,8816.227621,8905.079759,8845.704703,8728.13961,8670.065907,8497.795384,8218.366001,7764.348249,7484.013675,7213.699509,6953.246305,6702.10286,6206.038814,5727.541481,5146.363916,4733.675853,4296.273055,3671.546476,2876.394654,2238.456351,1777.267237,1373.875933,1010.092415),
        col=col2,lty="dashed"), # Arc basalts
        
        lines2=list(
        "lines",
        x=c(148.2234109,135.5723587,116.4550919,102.3773567,86.50004734,71.88857911,60.54046887,52.69646172,45.41521329,40.32222635,37.12530371,36.15691622,36.2768838,37.12530371,38.62699944,40.32222635,42.79301941,45.56589963,49.9825227,58.18684668,69.55207715,80.17020979,94.26043164,111.9292371,127.7446511,145.792736,160.4547949,174.2718284,178.9393354,178.9393354,170.8518628,160.9871792,154.2168193,148.2234109),
        y=c(17264.02949,16474.43864,15102.85332,13845.45983,12112.23308,10316.33984,8845.704703,7738.366107,6547.136685,5595.030666,4960.552604,4670.82777,4383.368728,4155.00054,3991.580727,3809.074474,3758.44943,3771.068705,3938.585295,4354.081337,4977.20803,5651.418779,6547.136685,7790.30837,8994.827371,10525.47658,11951.42134,13661.44478,14508.84486,15826.48453,17091.53462,17379.9109,17379.9109,17264.02949),
        col=col2,lty="dashed"),  # MORB
        
        lines3=list(
        "lines",
        x=c(552.1097404,496.7122384,461.8852647,428.0857608,395.447529,367.725826,352.265898,341.9427333,331.9266897,321.1385037,306.6198442,279.5258881,248.1790861,219.6219555,193.0674876,170.8518628,140.126717,114.1713227,97.74888027,86.21518676,77.05451322,70.47781484,64.67633033,60.54046887,57.80343657,56.29567449,55.37326468,55.74055546,57.61307922,61.34541188,67.29244816,74.30357248,85.36503812,100.0363533,120.7666081,144.3551065,173.6955118,215.3090404,269.5502065,322.1995662,360.5094578,412.8082948,461.8852647,500,520.231903,544.8501366,563.153593,599.6528431,634.2927297,677.6248496,728.7088735,815.3418794),
        y=c(1378.469491,1554.804043,1718.826116,1932.211724,2238.456351,2628.095355,3075.318177,3610.676958,4267.627444,4749.569523,5146.363916,5804.608121,6438.59358,6906.885194,7286.40097,7584.714436,8055.183535,8469.477661,8757.444991,8964.853358,9207.857822,9616.88483,10179.37182,10919.73762,11871.73465,13080.39385,14753.43789,16201.31364,17791.28131,19537.55954,21526.67501,23325.08304,25786.09462,28127.89244,30478.21496,32476.96044,33581.19661,34147.31518,33469.29194,32368.73548,30992.02283,28987.33843,26573.98713,24607.08214,23325.08304,21240.86959,19407.01972,16529.7528,14508.84486,12524.05628,10810.78385,8786.725533),
        col=col2,lty="dashed"),  # Intraplate
        
        GCDkit=list("NULL",plot.type="binary",plot.position=208,plot.name="Pearce (1982)")  
    )

if(getOption("gcd.plot.text")){       
    temp<-c(temp,list(       
        text1=list("text",x=300,y=10000,text="Within-Plate\nLavas",col=col2),
        text2=list("text",x=100,y=3000,text="Island Arc\nLavas",col=col2),
        text3=list("text",x=70,y=7000,text="MORB",col=col2)
    ))
}
    
sheet<<-list(demo=list(fun="plot", call=list(
                        main=annotate("Zr-Ti (Pearce 1982)"),
                        xlim=c(10,800),
                        ylim=c(1000,50000),
                        col="green",
                        bg="transparent",
                        fg="black",
                        log="xy",
                        xlab="Zr",
                        ylab="Ti",
                        xaxs="i",
                        yaxs="i"),
                template=temp))


}
